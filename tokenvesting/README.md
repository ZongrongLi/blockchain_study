
# 函数说明：
1. 锁仓合约初始化函数constructor(...)，包含5个参数：

 address _beneficiary：接受通证投放的收益账户；
 uint256 _start： 起始时间（Unix time），提示从什么时刻开始计时；
 uint256 _cliff： 单位为秒（s），断崖时间，例如“锁仓4年，1年之后一次性解冻25%”中的1年
 uint256 _duration： 单位为秒（s），持续锁仓时间，例如“锁仓4年，1年之后一次性解冻25%”中的4年；
 bool _revocable： 是否可回收 （例如公司给了员工张三 10K 代币锁仓4年，张三在工作一年的时候离职了，剩余的部分公司是否可回收）
 举例来说明：
 如果 _cliff=半年 ，_duration=1年 具体解冻情况如下：
 Month 1: I get 0 tokens
 Month 2: I get 0 tokens
 Month 3: I get 0 tokens
 Month 4: I get 0 tokens
 Month 5: I get 0 tokens
 Month 6: I get 0 tokens --- End of cliff
 Month 7: I get 700 tokens (7/12th)
 Month 8: I get 100 tokens (8/12th)
 Month 9: I get 100 tokens (9/12th)
 Month 10: I get 100 tokens (10/12th)
 Month 11: I get 100 tokens (11/12th)
 Month 12: I get 100 tokens (12/12th)
2. 期权代币释放函数release(...)，包含1个参数：

 Colorbay _token：_token为CLB代币的实例参数，时间到后通过该函数释放给对应的收益账户；
 期权代币回收函数revoke(...)，包含1个参数：

 Colorbay _token：_token为CLB代币的实例参数，把未释放的代币打回给之前的分配账户池；

 完整的代码和CLB通证的调用函数，存放到知识星球，欢迎加入下载。

3.  测试用例验证
-   管理员账号发布一个ERC20的ColorBay代币合约

 管理员地址：
 0xca35b7d915458ef540ade6068dfe2f44e8fa733c
 代币合约信息如下：
 (1) decimals = 18; (2) totalSupply() = 10亿； (3) symbol = CLB (4) paused = false
 (5) owner = 0xca35b7d915458ef540ade6068dfe2f44e8fa733c
 (6) contract address = 0x692a70d2e424a56d2c6c27aa97d1a86395877b3a

CLB相关信息

-  管理员账号转发500万给员工激励专用账号用于期权激励专用

 管理员地址：
 0xca35b7d915458ef540ade6068dfe2f44e8fa733c
 员工激励专用账号地址：
 0x14723a09acff6d2a60dcdf7aa4aff308fddc160c
 转账操作：(记得去除500万后面的",")
 transfer("0x14723a09acff6d2a60dcdf7aa4aff308fddc160c", "5000000,000000000000000000")
 【结果验证】
 balanceOf("0x14723a09acff6d2a60dcdf7aa4aff308fddc160c")
 检查确认余额为500万CLB。
-  当前账号切换到员工激励专用账号下创建期权激励计划

 场景假设：
 激励计划起始时间为[2018.08.06 20:25]，2分钟内不得释放，持续5分钟(300s),支持回收未释放的期权
 员工激励专用账号地址：
 0x14723a09acff6d2a60dcdf7aa4aff308fddc160c
 被员工李四的私人收益账号地址：
 0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db
 调用函数：  constructor("0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db", "1533558300", "120", "300", true)
 【说明】如何获得准确的起始时间，可用站长工具输入具体时间来转换。
 期权激励智能合约实例创建成功信息如下：
 (1) contract address = 0x0fdf4894a3b7c5a101686829063be52ad45bcfb7
-  在CLB合约下，把CLB通证打给期权激励智能合约地址

 切换到员工激励专用账号
 0x14723a09acff6d2a60dcdf7aa4aff308fddc160c
 执行转账操作，（记得去除100万后面的","）
 transfer("0x0fdf4894a3b7c5a101686829063be52ad45bcfb7", "1000000,000000000000000000")
 结果
 balanceOf("0x0fdf4894a3b7c5a101686829063be52ad45bcfb7") 检查确认余额为100万，表示CLB代币已经转给期权激励智能合约了。
-  [2018.08.06 17:31] 5分钟(300s)后测试分配期权

 执行期权是否操作
 release("0x692a70d2e424a56d2c6c27aa97d1a86395877b3a")
 切换到CLB合约下，查询李四私人账号
 balanceOf("0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db") 检查确认余额为100万，转账成功。
   
 


 
 查询结果
 
 

-  离职员工激励计划实施

场景假设
 当前账号切换到员工激励专用账号下创建期权激励计划，假定给员工王五做的激励，起始时间为[2018.08.06 21:00]，2分钟内不得释放，持续5分钟(300s),支持回收期权。王五在4分钟的时候离职，公司收回未激励代币，打回到员工激励专用账号下。
员工激励专用账号：
 0x14723a09acff6d2a60dcdf7aa4aff308fddc160c
被员工王五私人收益账号：
 0x583031d1113ad414f02576bd6afabfb302140225
执行操作：  constructor("0x583031d1113ad414f02576bd6afabfb302140225", "1533560400", "120", "300", true)
期权激励智能合约信息如下：
 contract address = 0x15e08fa9fe3e3aa3607ac57a29f92b5d8cb154a2
-  在CLB合约下，通证打给期权激励智能合约地址

 切换到员工激励专用账号，在CLB合约下操作
 0x14723a09acff6d2a60dcdf7aa4aff308fddc160c
 王五期权激励智能合约实例地址：
 0x15e08fa9fe3e3aa3607ac57a29f92b5d8cb154a2
 具体操作（记得去除100万后面的","）
 transfer("0x15e08fa9fe3e3aa3607ac57a29f92b5d8cb154a2", "1000000,000000000000000000")
 查询王五期权激励智能合约的账户余额：
 balanceOf("0x15e08fa9fe3e3aa3607ac57a29f92b5d8cb154a2") 检查确认余额为100万
 查询员工期权激励智能合约的账户余额：
 balanceOf("0x14723a09acff6d2a60dcdf7aa4aff308fddc160c")
 检查确认余额为300万
- [2018.08.06 21:03] 3分钟(180s)后测试分配期权

 2分钟内操作release均会失败回滚。21:03操作释放函数：
 release("0x692a70d2e424a56d2c6c27aa97d1a86395877b3a")
 切换到CLB合约下，查询王五私人账号
 balanceOf("0x583031d1113ad414f02576bd6afabfb302140225") 检查有76万代币释放到王五收益账户。
   
 

- [2018.08.06 21:05] 4分钟(240s)后，李四离职，收回分配期权
 revoke("0x692a70d2e424a56d2c6c27aa97d1a86395877b3a")

 切换到CLB合约下，查询李四私人账号
 balanceOf("0x583031d1113ad414f02576bd6afabfb302140225") 检查有76万代币在王五收益账户，没有增加。
 
   
 

查询员工专用账户余额
 balanceOf("0x14723a09acff6d2a60dcdf7aa4aff308fddc160c")
 发现王五剩余未释放的额度全部返回到员工专用账号了。
4. 商用实现需求
给了一个命题需求，看看谁能把这个需求实现。除了功能，要提供网页查询页面，用户输入以太坊地址，可以查到对应账户的期权代币总额，已释放额度，未释放额度。

某项目方发布10亿的代币总额，其中：
 - 机构方私募为 1.5 亿枚， 上交易所后私募锁仓三个月，之后逐月释放 20%；
 - 基金会核心运作团队持有 2 亿枚， 锁定一年， 两年内逐步释放；
 - 社区建设 1 亿枚， 海外社区核心团队， 锁定一年，两年内逐步释放；

转化为具体的时间点动作为：
 - 私募总额1.5亿枚，2018.09.01上交易所，私募锁仓三个月到2018.12.01到期，之后逐月释放情况
 [2019.01.01 - 20%, 3000万枚; 2019.02.01 - 20%, 3000万枚; 2019.03.01 - 20%, 3000万枚; 2019.04.01 20%, 3000万枚; 2019.05.01 20%, 3000万枚; ]
 - 基金会核心运作团队 2亿枚,2018.09.01上交易所，锁定一年到2019.09.01， 两年内按月逐步释放；
 [2019.10.01 - 2亿1/24, 约833万枚; ...; 2020.10.01 - 2亿1/24, 约833万枚;]
 -  海外社区核心团队 1 亿枚，2018.09.01上交易所，锁定一年到2019.09.01，两年内逐步释放；
 [2019.10.01 - 1亿1/24, 约416万枚; ...; 2020.10.01 - 1亿1/24, 约416万枚;]